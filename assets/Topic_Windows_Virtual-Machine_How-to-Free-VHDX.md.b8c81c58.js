import{_ as s,c as a,o as e,a as n}from"./app.0abe111d.js";const u=JSON.parse('{"title":"虚拟机镜像存储压缩","description":"","frontmatter":{},"headers":[{"level":2,"title":"压缩 VHDX 镜像","slug":"压缩-vhdx-镜像","link":"#压缩-vhdx-镜像","children":[]},{"level":2,"title":"报错解决","slug":"报错解决","link":"#报错解决","children":[{"level":3,"title":"问题一","slug":"问题一","link":"#问题一","children":[]}]}],"relativePath":"Topic/Windows/Virtual-Machine/How-to-Free-VHDX.md","lastUpdated":1678597845000}'),l={name:"Topic/Windows/Virtual-Machine/How-to-Free-VHDX.md"},t=n(`<h1 id="虚拟机镜像存储压缩" tabindex="-1">虚拟机镜像存储压缩 <a class="header-anchor" href="#虚拟机镜像存储压缩" aria-hidden="true">#</a></h1><h2 id="压缩-vhdx-镜像" tabindex="-1">压缩 VHDX 镜像 <a class="header-anchor" href="#压缩-vhdx-镜像" aria-hidden="true">#</a></h2><p>Windows 的各种子系统/虚拟机系统的映像均以虚拟硬盘( VHDX，后缀为<code>.vhdx</code> )的形式存储在我们的硬盘中。</p><p>日常使用的过程中，随着文件的增多，对应虚拟磁盘的大小也会不断增加。但由于虚拟机的特性，即使我们手动删除一些文件后，虚拟硬盘不能自己释放空间减少硬盘占用。</p><p>为了避免电脑硬盘空间被浪费，当我们虚拟硬盘容量虚高的时候，可以运行如下代码进行虚拟硬盘的压缩，从而释放空间。</p><div class="language-powershell"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">diskpart                                </span><span style="color:#676E95;font-style:italic;"># 打开 diskpart 工具</span></span>
<span class="line"><span style="color:#A6ACCD;">select vdisk file</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">\\path\\to\\your\\vhdx</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;"># 选择vhdk镜像</span></span>
<span class="line"><span style="color:#A6ACCD;">attach vdisk readonly                   </span><span style="color:#676E95;font-style:italic;"># 以只读附加镜像</span></span>
<span class="line"><span style="color:#A6ACCD;">compact vdisk                           </span><span style="color:#676E95;font-style:italic;"># 压缩镜像</span></span>
<span class="line"><span style="color:#A6ACCD;">detach vdisk                            </span><span style="color:#676E95;font-style:italic;"># 分离镜像</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">exit</span><span style="color:#A6ACCD;">                                    </span><span style="color:#676E95;font-style:italic;"># 退出 diskpart</span></span>
<span class="line"></span></code></pre></div><h2 id="报错解决" tabindex="-1">报错解决 <a class="header-anchor" href="#报错解决" aria-hidden="true">#</a></h2><h3 id="问题一" tabindex="-1">问题一 <a class="header-anchor" href="#问题一" aria-hidden="true">#</a></h3><p>如果您遇到 <code>Virtual hard disk files must be uncompressed and unencrypted and must not be sparse</code> 这类提示，请在命令行中运行如下代码：</p><div class="language-powershell"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">fsutil sparse setflag path</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">to</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">file.vhdx </span><span style="color:#F78C6C;">0</span></span>
<span class="line"></span></code></pre></div><p>随后再次压缩镜像即可完成操作。</p>`,11),o=[t];function p(c,i,r,d,h,y){return e(),a("div",null,o)}const C=s(l,[["render",p]]);export{u as __pageData,C as default};
