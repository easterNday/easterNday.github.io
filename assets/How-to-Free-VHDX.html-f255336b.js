import{_ as e,p as a,q as s,a1 as n}from"./framework-96b046e1.js";const d={},i=n(`<h1 id="虚拟机镜像存储压缩" tabindex="-1"><a class="header-anchor" href="#虚拟机镜像存储压缩" aria-hidden="true">#</a> 虚拟机镜像存储压缩</h1><h2 id="压缩-vhdx-镜像" tabindex="-1"><a class="header-anchor" href="#压缩-vhdx-镜像" aria-hidden="true">#</a> 压缩 VHDX 镜像</h2><p>Windows 的各种子系统/虚拟机系统的映像均以虚拟硬盘( VHDX，后缀为<code>.vhdx</code> )的形式存储在我们的硬盘中。</p><p>日常使用的过程中，随着文件的增多，对应虚拟磁盘的大小也会不断增加。但由于虚拟机的特性，即使我们手动删除一些文件后，虚拟硬盘不能自己释放空间减少硬盘占用。</p><p>为了避免电脑硬盘空间被浪费，当我们虚拟硬盘容量虚高的时候，可以运行如下代码进行虚拟硬盘的压缩，从而释放空间。</p><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code>diskpart                                <span class="token comment"># 打开 diskpart 工具</span>
<span class="token function">select</span> vdisk file=<span class="token string">&quot;\\path\\to\\your\\vhdx&quot;</span>  <span class="token comment"># 选择vhdk镜像</span>
attach vdisk readonly                   <span class="token comment"># 以只读附加镜像</span>
compact vdisk                           <span class="token comment"># 压缩镜像</span>
detach vdisk                            <span class="token comment"># 分离镜像</span>
<span class="token keyword">exit</span>                                    <span class="token comment"># 退出 diskpart</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="报错解决" tabindex="-1"><a class="header-anchor" href="#报错解决" aria-hidden="true">#</a> 报错解决</h2><h3 id="问题一" tabindex="-1"><a class="header-anchor" href="#问题一" aria-hidden="true">#</a> 问题一</h3><p>如果您遇到 <code>Virtual hard disk files must be uncompressed and unencrypted and must not be sparse</code> 这类提示，请在命令行中运行如下代码：</p><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code>fsutil sparse setflag path/to/file<span class="token punctuation">.</span>vhdx 0
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>随后再次压缩镜像即可完成操作。</p>`,11),t=[i];function r(l,c){return a(),s("div",null,t)}const p=e(d,[["render",r],["__file","How-to-Free-VHDX.html.vue"]]);export{p as default};
